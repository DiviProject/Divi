\hypertarget{class_c_coins}{}\section{C\+Coins Class Reference}
\label{class_c_coins}\index{C\+Coins@{C\+Coins}}


{\ttfamily \#include $<$coins.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_c_coins_abf67e501a1d207c892c1f52dd383956e}\label{class_c_coins_abf67e501a1d207c892c1f52dd383956e}} 
void {\bfseries From\+Tx} (const \mbox{\hyperlink{class_c_transaction}{C\+Transaction}} \&tx, int n\+Height\+In)
\item 
\mbox{\Hypertarget{class_c_coins_a303f3b245c339c11a1ea4318b01ec290}\label{class_c_coins_a303f3b245c339c11a1ea4318b01ec290}} 
\mbox{\hyperlink{class_c_coins_a303f3b245c339c11a1ea4318b01ec290}{C\+Coins}} (const \mbox{\hyperlink{class_c_transaction}{C\+Transaction}} \&tx, int n\+Height\+In)
\begin{DoxyCompactList}\small\item\em construct a \mbox{\hyperlink{class_c_coins}{C\+Coins}} from a \mbox{\hyperlink{class_c_transaction}{C\+Transaction}}, at a given height \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_a4d4197688436b752234bea95f0230b82}\label{class_c_coins_a4d4197688436b752234bea95f0230b82}} 
void {\bfseries Clear} ()
\item 
\mbox{\Hypertarget{class_c_coins_a543757065d6c77d23953a33eecb31a46}\label{class_c_coins_a543757065d6c77d23953a33eecb31a46}} 
\mbox{\hyperlink{class_c_coins_a543757065d6c77d23953a33eecb31a46}{C\+Coins}} ()
\begin{DoxyCompactList}\small\item\em empty constructor \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_a7cfa2efc07f4d35785c9c75caa8bddcb}\label{class_c_coins_a7cfa2efc07f4d35785c9c75caa8bddcb}} 
void \mbox{\hyperlink{class_c_coins_a7cfa2efc07f4d35785c9c75caa8bddcb}{Cleanup}} ()
\begin{DoxyCompactList}\small\item\em remove spent outputs at the end of vout \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_ad8b649abb32bdba255adec6dcfd57fc5}\label{class_c_coins_ad8b649abb32bdba255adec6dcfd57fc5}} 
void {\bfseries Clear\+Unspendable} ()
\item 
\mbox{\Hypertarget{class_c_coins_a9581324a74e9500b3d2cad472c0a830f}\label{class_c_coins_a9581324a74e9500b3d2cad472c0a830f}} 
void {\bfseries swap} (\mbox{\hyperlink{class_c_coins}{C\+Coins}} \&to)
\item 
void \mbox{\hyperlink{class_c_coins_a7fc7a42f2b5d7cf7476bfe3e10141e18}{Calc\+Mask\+Size}} (unsigned int \&n\+Bytes, unsigned int \&n\+Nonzero\+Bytes) const
\item 
\mbox{\Hypertarget{class_c_coins_a976c1374c3398e1ee23b1110f1663895}\label{class_c_coins_a976c1374c3398e1ee23b1110f1663895}} 
bool {\bfseries Is\+Coin\+Base} () const
\item 
\mbox{\Hypertarget{class_c_coins_ace818e478f11f06a6f9bebd7adb5933e}\label{class_c_coins_ace818e478f11f06a6f9bebd7adb5933e}} 
bool {\bfseries Is\+Coin\+Stake} () const
\item 
\mbox{\Hypertarget{class_c_coins_a63916fcdb2305c47e6360cf533c27438}\label{class_c_coins_a63916fcdb2305c47e6360cf533c27438}} 
unsigned int {\bfseries Get\+Serialize\+Size} (int n\+Type, int \mbox{\hyperlink{class_c_coins_a96fea4ee8841e9ce32f60c2e7e3cf6b6}{n\+Version}}) const
\item 
\mbox{\Hypertarget{class_c_coins_a7adea91f27b75755e8cfbc7c46fe3848}\label{class_c_coins_a7adea91f27b75755e8cfbc7c46fe3848}} 
{\footnotesize template$<$typename Stream $>$ }\\void {\bfseries Serialize} (Stream \&s, int n\+Type, int \mbox{\hyperlink{class_c_coins_a96fea4ee8841e9ce32f60c2e7e3cf6b6}{n\+Version}}) const
\item 
\mbox{\Hypertarget{class_c_coins_adaa98cb6d8da3a4d573cd799ddd11051}\label{class_c_coins_adaa98cb6d8da3a4d573cd799ddd11051}} 
{\footnotesize template$<$typename Stream $>$ }\\void {\bfseries Unserialize} (Stream \&s, int n\+Type, int \mbox{\hyperlink{class_c_coins_a96fea4ee8841e9ce32f60c2e7e3cf6b6}{n\+Version}})
\item 
\mbox{\Hypertarget{class_c_coins_a8d5fe8c1ab0c9558620448a19ecdb8b2}\label{class_c_coins_a8d5fe8c1ab0c9558620448a19ecdb8b2}} 
bool \mbox{\hyperlink{class_c_coins_a8d5fe8c1ab0c9558620448a19ecdb8b2}{Spend}} (const \mbox{\hyperlink{class_c_out_point}{C\+Out\+Point}} \&out, \mbox{\hyperlink{class_c_tx_in_undo}{C\+Tx\+In\+Undo}} \&undo)
\begin{DoxyCompactList}\small\item\em mark an outpoint spent, and construct undo information \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_a99210076cac4b1ac521a532d3b5df182}\label{class_c_coins_a99210076cac4b1ac521a532d3b5df182}} 
bool \mbox{\hyperlink{class_c_coins_a99210076cac4b1ac521a532d3b5df182}{Spend}} (int n\+Pos)
\begin{DoxyCompactList}\small\item\em mark a vout spent \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_aa645bc3d18f74e91430ac178a9d28ee4}\label{class_c_coins_aa645bc3d18f74e91430ac178a9d28ee4}} 
bool \mbox{\hyperlink{class_c_coins_aa645bc3d18f74e91430ac178a9d28ee4}{Is\+Available}} (unsigned int n\+Pos) const
\begin{DoxyCompactList}\small\item\em check whether a particular output is still available \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_c_coins_a597a7cb8830fc29565918ce1823b2244}{Is\+Pruned}} () const
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_c_coins_adeedfaef84ba39b6e295d5d1fb9d8f0b}\label{class_c_coins_adeedfaef84ba39b6e295d5d1fb9d8f0b}} 
bool \mbox{\hyperlink{class_c_coins_adeedfaef84ba39b6e295d5d1fb9d8f0b}{f\+Coin\+Base}}
\begin{DoxyCompactList}\small\item\em whether transaction is a coinbase \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_acdb04fc05b8c2b5a75914c8aaedcd27d}\label{class_c_coins_acdb04fc05b8c2b5a75914c8aaedcd27d}} 
bool {\bfseries f\+Coin\+Stake}
\item 
\mbox{\Hypertarget{class_c_coins_a1dcea1a6da9b25642337e286f9f59b03}\label{class_c_coins_a1dcea1a6da9b25642337e286f9f59b03}} 
std\+::vector$<$ \mbox{\hyperlink{class_c_tx_out}{C\+Tx\+Out}} $>$ \mbox{\hyperlink{class_c_coins_a1dcea1a6da9b25642337e286f9f59b03}{vout}}
\begin{DoxyCompactList}\small\item\em unspent transaction outputs; spent outputs are .Is\+Null(); spent outputs at the end of the array are dropped \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_af7396dfad71367de46f21cf92e2c70ab}\label{class_c_coins_af7396dfad71367de46f21cf92e2c70ab}} 
int \mbox{\hyperlink{class_c_coins_af7396dfad71367de46f21cf92e2c70ab}{n\+Height}}
\begin{DoxyCompactList}\small\item\em at which height this transaction was included in the active block chain \end{DoxyCompactList}\item 
int \mbox{\hyperlink{class_c_coins_a96fea4ee8841e9ce32f60c2e7e3cf6b6}{n\+Version}}
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_c_coins_a77593e3db3e4b369c21a91aad2afcc05}\label{class_c_coins_a77593e3db3e4b369c21a91aad2afcc05}} 
bool \mbox{\hyperlink{class_c_coins_a77593e3db3e4b369c21a91aad2afcc05}{operator==}} (const \mbox{\hyperlink{class_c_coins}{C\+Coins}} \&a, const \mbox{\hyperlink{class_c_coins}{C\+Coins}} \&b)
\begin{DoxyCompactList}\small\item\em equality test \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_c_coins_a42ef9fcc8ca59916b5fb69904db1c9bd}\label{class_c_coins_a42ef9fcc8ca59916b5fb69904db1c9bd}} 
bool {\bfseries operator!=} (const \mbox{\hyperlink{class_c_coins}{C\+Coins}} \&a, const \mbox{\hyperlink{class_c_coins}{C\+Coins}} \&b)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Note -\/ for P\+I\+VX we added f\+Coin\+Stake to the 2nd bit. Keep in mind when reading the following and adjust as needed. Pruned version of \mbox{\hyperlink{class_c_transaction}{C\+Transaction}}\+: only retains metadata and unspent transaction outputs

Serialized format\+:
\begin{DoxyItemize}
\item V\+A\+R\+I\+N\+T(n\+Version)
\item V\+A\+R\+I\+N\+T(n\+Code)
\item unspentness bitvector, for vout\mbox{[}2\mbox{]} and further; least significant byte first
\item the non-\/spent C\+Tx\+Outs (via \mbox{\hyperlink{class_c_tx_out_compressor}{C\+Tx\+Out\+Compressor}})
\item V\+A\+R\+I\+N\+T(n\+Height)
\end{DoxyItemize}

The n\+Code value consists of\+:
\begin{DoxyItemize}
\item bit 1\+: Is\+Coin\+Base()
\item bit 2\+: vout\mbox{[}0\mbox{]} is not spent
\item bit 4\+: vout\mbox{[}1\mbox{]} is not spent
\item The higher bits encode N, the number of non-\/zero bytes in the following bitvector.
\begin{DoxyItemize}
\item In case both bit 2 and bit 4 are unset, they encode N-\/1, as there must be at least one non-\/spent output).
\end{DoxyItemize}
\end{DoxyItemize}

Example\+: 0104835800816115944e077fe7c803cfa57f29b36bf87c1d358bb85e $<$$>$$<$$>$$<$-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---$>$$<$-\/---$>$ $\vert$ \textbackslash{} $\vert$ / version code vout\mbox{[}1\mbox{]} height


\begin{DoxyItemize}
\item version = 1
\item code = 4 (vout\mbox{[}1\mbox{]} is not spent, and 0 non-\/zero bytes of bitvector follow)
\item unspentness bitvector\+: as 0 non-\/zero bytes follow, it has length 0
\item vout\mbox{[}1\mbox{]}\+: 835800816115944e077fe7c803cfa57f29b36bf87c1d35
\begin{DoxyItemize}
\item 8358\+: compact amount representation for 60000000000 (600 B\+TC)
\item 00\+: special txout type pay-\/to-\/pubkey-\/hash
\item 816115944e077fe7c803cfa57f29b36bf87c1d35\+: address \mbox{\hyperlink{classuint160}{uint160}}
\end{DoxyItemize}
\item height = 203998
\end{DoxyItemize}

Example\+: 0109044086ef97d5790061b01caab50f1b8e9c50a5057eb43c2d9563a4eebbd123008c988f1a4a4de2161e0f50aac7f17e7f9555caa486af3b $<$$>$$<$$>$$<$--$>$$<$-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---$>$$<$-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/---$>$$<$-\/---$>$ / \textbackslash{} \textbackslash{} $\vert$ $\vert$ / version code unspentness vout\mbox{[}4\mbox{]} vout\mbox{[}16\mbox{]} height


\begin{DoxyItemize}
\item version = 1
\item code = 9 (coinbase, neither vout\mbox{[}0\mbox{]} or vout\mbox{[}1\mbox{]} are unspent, 2 (1, +1 because both bit 2 and bit 4 are unset) non-\/zero bitvector bytes follow)
\item unspentness bitvector\+: bits 2 (0x04) and 14 (0x4000) are set, so vout\mbox{[}2+2\mbox{]} and vout\mbox{[}14+2\mbox{]} are unspent
\item vout\mbox{[}4\mbox{]}\+: 86ef97d5790061b01caab50f1b8e9c50a5057eb43c2d9563a4ee
\begin{DoxyItemize}
\item 86ef97d579\+: compact amount representation for 234925952 (2.\+35 B\+TC)
\item 00\+: special txout type pay-\/to-\/pubkey-\/hash
\item 61b01caab50f1b8e9c50a5057eb43c2d9563a4ee\+: address \mbox{\hyperlink{classuint160}{uint160}}
\end{DoxyItemize}
\item vout\mbox{[}16\mbox{]}\+: bbd123008c988f1a4a4de2161e0f50aac7f17e7f9555caa4
\begin{DoxyItemize}
\item bbd123\+: compact amount representation for 110397 (0.\+001 B\+TC)
\item 00\+: special txout type pay-\/to-\/pubkey-\/hash
\item 8c988f1a4a4de2161e0f50aac7f17e7f9555caa4\+: address \mbox{\hyperlink{classuint160}{uint160}}
\end{DoxyItemize}
\item height = 120891 
\end{DoxyItemize}

\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_c_coins_a7fc7a42f2b5d7cf7476bfe3e10141e18}\label{class_c_coins_a7fc7a42f2b5d7cf7476bfe3e10141e18}} 
\index{C\+Coins@{C\+Coins}!Calc\+Mask\+Size@{Calc\+Mask\+Size}}
\index{Calc\+Mask\+Size@{Calc\+Mask\+Size}!C\+Coins@{C\+Coins}}
\subsubsection{\texorpdfstring{Calc\+Mask\+Size()}{CalcMaskSize()}}
{\footnotesize\ttfamily void C\+Coins\+::\+Calc\+Mask\+Size (\begin{DoxyParamCaption}\item[{unsigned int \&}]{n\+Bytes,  }\item[{unsigned int \&}]{n\+Nonzero\+Bytes }\end{DoxyParamCaption}) const}

calculate number of bytes for the bitmask, and its number of non-\/zero bytes each bit in the bitmask represents the availability of one output, but the availabilities of the first two outputs are encoded separately \mbox{\Hypertarget{class_c_coins_a597a7cb8830fc29565918ce1823b2244}\label{class_c_coins_a597a7cb8830fc29565918ce1823b2244}} 
\index{C\+Coins@{C\+Coins}!Is\+Pruned@{Is\+Pruned}}
\index{Is\+Pruned@{Is\+Pruned}!C\+Coins@{C\+Coins}}
\subsubsection{\texorpdfstring{Is\+Pruned()}{IsPruned()}}
{\footnotesize\ttfamily bool C\+Coins\+::\+Is\+Pruned (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}

check whether the entire \mbox{\hyperlink{class_c_coins}{C\+Coins}} is spent note that only !\+Is\+Pruned() \mbox{\hyperlink{class_c_coins}{C\+Coins}} can be serialized 

\subsection{Member Data Documentation}
\mbox{\Hypertarget{class_c_coins_a96fea4ee8841e9ce32f60c2e7e3cf6b6}\label{class_c_coins_a96fea4ee8841e9ce32f60c2e7e3cf6b6}} 
\index{C\+Coins@{C\+Coins}!n\+Version@{n\+Version}}
\index{n\+Version@{n\+Version}!C\+Coins@{C\+Coins}}
\subsubsection{\texorpdfstring{n\+Version}{nVersion}}
{\footnotesize\ttfamily int C\+Coins\+::n\+Version}

version of the \mbox{\hyperlink{class_c_transaction}{C\+Transaction}}; accesses to this value should probably check for n\+Height as well, as new tx version will probably only be introduced at certain heights 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
P\+I\+V\+X/src/coins.\+h\item 
P\+I\+V\+X/src/coins.\+cpp\end{DoxyCompactItemize}
